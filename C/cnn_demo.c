#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#include "cnn_demo.h"

// 3x3步长为2, padding为0的卷积核，支持选用relu激活
int conv2d_3x3_p1_s2(const float* input, const float* kernel, const float* bias, float* output,
    int activate, // 是否 Relu 激活
    int in_height, int in_width,
    int out_channel, int in_channel,
    int kernel_height, int kernel_width
) {
    const int stride = 2;
    int out_height = (in_height - kernel_height) / stride + 1;
    int out_width = (in_width - kernel_width) / stride + 1;
    for (int oc = 0; oc < out_channel; oc++) { // 输出通道数
        for (int oh = 0; oh < out_height; oh++) { // 输出高度
            for (int ow = 0; ow < out_width; ow++) { // 输出宽度
                float sum = 0.0f;
                for (int ic = 0; ic < in_channel; ic++) { // 输入通道数
                    for (int kh = 0; kh < kernel_height; kh++) { // 卷积核高度
                        for (int kw = 0; kw < kernel_width; kw++) { // 卷积核宽度
                            sum += input[(ic * in_height + oh * stride + kh) * in_width + ow * stride + kw] * kernel[((oc * in_channel + ic) * kernel_height + kh) * kernel_width + kw]; // 浮点数乘、累加
                        }
                    }
                }
				sum += bias[oc]; // 偏置，浮点数加法
				if ((activate != 0) && (sum < 0)) sum = 0; // Relu 激活
                output[(oc * out_height + oh) * out_width + ow] = sum; // 输出到结果地址
            }
        }
    }
    return 0;
}

int main() {
    // 图像数据，运行export.py输出
    float image[IMAGE_H * IMAGE_W] = { 0.4627451002597809,0.3960784375667572,0.3960784375667572,0.33725491166114807,0.30980393290519714,0.30588236451148987,0.30588236451148987,0.2980392277240753,0.33725491166114807,0.3686274588108063,0.40392157435417175,0.46666666865348816,0.5098039507865906,0.5647059082984924,0.6392157077789307,0.7215686440467834,0.800000011920929,0.843137264251709,0.8313725590705872,0.8039215803146362,0.7568627595901489,0.6431372761726379,0.5333333611488342,0.46666666865348816,0.4313725531101227,0.4470588266849518,0.4431372582912445,0.47058823704719543,0.4941176474094391,0.49803921580314636,0.45490196347236633,0.4431372582912445,0.3843137323856354,0.3960784375667572,0.3450980484485626,0.33725491166114807,0.3686274588108063,0.3803921639919281,0.3921568691730499,0.45490196347236633,0.5411764979362488,0.6196078658103943,0.6941176652908325,0.7450980544090271,0.8196078538894653,0.9137254953384399,0.9725490212440491,0.9960784316062927,0.9921568632125854,0.9960784316062927,0.9960784316062927,0.9921568632125854,0.9450980424880981,0.7843137383460999,0.572549045085907,0.46666666865348816,0.48235294222831726,0.48627451062202454,0.47843137383461,0.4745098054409027,0.48235294222831726,0.4588235318660736,0.4431372582912445,0.38823530077934265,0.3843137323856354,0.3960784375667572,0.40392157435417175,0.4588235318660736,0.5137255191802979,0.47058823704719543,0.49803921580314636,0.545098066329956,0.48235294222831726,0.5058823823928833,0.5490196347236633,0.6196078658103943,0.729411780834198,0.8196078538894653,0.886274516582489,0.9333333373069763,0.95686274766922,0.9529411792755127,0.9647058844566345,0.9843137264251709,0.9686274528503418,0.8470588326454163,0.6627451181411743,0.5607843399047852,0.5137255191802979,0.5098039507865906,0.501960813999176,0.48627451062202454,0.4470588266849518,0.45490196347236633,0.4117647111415863,0.38823530077934265,0.40784314274787903,0.5058823823928833,0.5647059082984924,0.43921568989753723,0.3450980484485626,0.4588235318660736,0.5176470875740051,0.47843137383461,0.4745098054409027,0.46666666865348816,0.48627451062202454,0.5215686559677124,0.5568627715110779,0.5843137502670288,0.6313725709915161,0.7450980544090271,0.8784313797950745,0.9450980424880981,0.9607843160629272,0.9490196108818054,0.9098039269447327,0.6941176652908325,0.48235294222831726,0.5254902243614197,0.5529412031173706,0.4745098054409027,0.43529412150382996,0.45490196347236633,0.4901960790157318,0.43529412150382996,0.43921568989753723,0.5490196347236633,0.6235294342041016,0.5686274766921997,0.42352941632270813,0.4470588266849518,0.6039215922355652,0.572549045085907,0.4470588266849518,0.3450980484485626,0.3137255012989044,0.33725491166114807,0.34117648005485535,0.3176470696926117,0.2823529541492462,0.27450981736183167,0.364705890417099,0.6274510025978088,0.8470588326454163,0.8941176533699036,0.8941176533699036,0.843137264251709,0.6274510025978088,0.3960784375667572,0.45098039507865906,0.5764706134796143,0.5843137502670288,0.49803921580314636,0.48627451062202454,0.48627451062202454,0.45490196347236633,0.5529412031173706,0.6784313917160034,0.6117647290229797,0.5176470875740051,0.5215686559677124,0.5921568870544434,0.6000000238418579,0.4588235318660736,0.33725491166114807,0.2078431397676468,0.20000000298023224,0.2666666805744171,0.2980392277240753,0.3137255012989044,0.3176470696926117,0.29019609093666077,0.24313725531101227,0.34117648005485535,0.6196078658103943,0.7843137383460999,0.8039215803146362,0.7372549176216125,0.6392157077789307,0.5058823823928833,0.35686275362968445,0.38823530077934265,0.5254902243614197,0.529411792755127,0.4941176474094391,0.46666666865348816,0.46666666865348816,0.6274510025978088,0.6078431606292725,0.5058823823928833,0.49803921580314636,0.5215686559677124,0.5411764979362488,0.501960813999176,0.40784314274787903,0.29411765933036804,0.18039216101169586,0.26274511218070984,0.3960784375667572,0.3921568691730499,0.3490196168422699,0.3176470696926117,0.29411765933036804,0.239215686917305,0.23529411852359772,0.5098039507865906,0.7137255072593689,0.6431372761726379,0.501960813999176,0.4470588266849518,0.46666666865348816,0.33725491166114807,0.25882354378700256,0.3921568691730499,0.48235294222831726,0.45098039507865906,0.5372549295425415,0.5921568870544434,0.6000000238418579,0.45490196347236633,0.3803921639919281,0.37254902720451355,0.40784314274787903,0.43529412150382996,0.45490196347236633,0.3490196168422699,0.21568627655506134,0.1764705926179886,0.30588236451148987,0.4117647111415863,0.4117647111415863,0.33725491166114807,0.239215686917305,0.23137255012989044,0.250980406999588,0.3333333432674408,0.6078431606292725,0.7450980544090271,0.6117647290229797,0.38823530077934265,0.2078431397676468,0.18431372940540314,0.20392157137393951,0.18431372940540314,0.3137255012989044,0.45098039507865906,0.4274509847164154,0.7960784435272217,0.7215686440467834,0.48627451062202454,0.3176470696926117,0.2666666805744171,0.26274511218070984,0.3137255012989044,0.3529411852359772,0.3490196168422699,0.2862745225429535,0.19607843458652496,0.1411764770746231,0.1882352977991104,0.24705882370471954,0.21960784494876862,0.12941177189350128,0.05882352963089943,0.10196078568696976,0.24313725531101227,0.4941176474094391,0.7333333492279053,0.8117647171020508,0.7921568751335144,0.572549045085907,0.239215686917305,0.09019608050584793,0.10588235408067703,0.15294118225574493,0.27843138575553894,0.43921568989753723,0.42352941632270813,0.8117647171020508,0.5568627715110779,0.3764705955982208,0.2705882489681244,0.23137255012989044,0.21568627655506134,0.23529411852359772,0.25882354378700256,0.29019609093666077,0.32549020648002625,0.22745098173618317,0.12941177189350128,0.09803921729326248,0.1568627506494522,0.16078431904315948,0.1411764770746231,0.14901961386203766,0.1921568661928177,0.42352941632270813,0.7254902124404907,0.8470588326454163,0.8470588326454163,0.843137264251709,0.8039215803146362,0.6235294342041016,0.3294117748737335,0.1568627506494522,0.20000000298023224,0.2980392277240753,0.4117647111415863,0.40392157435417175,0.6431372761726379,0.4117647111415863,0.3176470696926117,0.2823529541492462,0.24705882370471954,0.1921568661928177,0.1725490242242813,0.19607843458652496,0.27843138575553894,0.37254902720451355,0.27450981736183167,0.1921568661928177,0.16470588743686676,0.18039216101169586,0.23529411852359772,0.2980392277240753,0.364705890417099,0.5215686559677124,0.7372549176216125,0.8274509906768799,0.7568627595901489,0.5960784554481506,0.48627451062202454,0.4745098054409027,0.5176470875740051,0.5215686559677124,0.3450980484485626,0.30588236451148987,0.35686275362968445,0.3803921639919281,0.3764705955982208,0.5764706134796143,0.4117647111415863,0.30980393290519714,0.27843138575553894,0.2549019753932953,0.1764705926179886,0.1411764770746231,0.1568627506494522,0.239215686917305,0.3686274588108063,0.30980393290519714,0.23529411852359772,0.24313725531101227,0.2078431397676468,0.21960784494876862,0.3450980484485626,0.5137255191802979,0.7529411911964417,0.8627451062202454,0.8156862854957581,0.5372549295425415,0.20000000298023224,0.09803921729326248,0.08235294371843338,0.07450980693101883,0.3333333432674408,0.5215686559677124,0.3960784375667572,0.3960784375667572,0.3686274588108063,0.3607843220233917,0.572549045085907,0.42352941632270813,0.2980392277240753,0.25882354378700256,0.22745098173618317,0.1764705926179886,0.12156862765550613,0.11372549086809158,0.1725490242242813,0.3137255012989044,0.30980393290519714,0.250980406999588,0.2862745225429535,0.239215686917305,0.1882352977991104,0.3490196168422699,0.6078431606292725,0.8039215803146362,0.8509804010391235,0.7960784435272217,0.572549045085907,0.2705882489681244,0.08627451211214066,0.0313725508749485,0.027450980618596077,0.3490196168422699,0.6431372761726379,0.4313725531101227,0.3764705955982208,0.34117648005485535,0.3450980484485626,0.545098066329956,0.3921568691730499,0.2666666805744171,0.23529411852359772,0.20392157137393951,0.18431372940540314,0.13333334028720856,0.10588235408067703,0.13333334028720856,0.27450981736183167,0.3019607961177826,0.24313725531101227,0.3019607961177826,0.2980392277240753,0.19607843458652496,0.2862745225429535,0.6000000238418579,0.800000011920929,0.8235294222831726,0.8039215803146362,0.7137255072593689,0.5137255191802979,0.27450981736183167,0.1568627506494522,0.19607843458652496,0.5529412031173706,0.729411780834198,0.45490196347236633,0.3529411852359772,0.34117648005485535,0.35686275362968445,0.5058823823928833,0.3607843220233917,0.27843138575553894,0.24705882370471954,0.21568627655506134,0.19607843458652496,0.16078431904315948,0.13725490868091583,0.1411764770746231,0.25882354378700256,0.3019607961177826,0.2549019753932953,0.3137255012989044,0.3137255012989044,0.23137255012989044,0.33725491166114807,0.6117647290229797,0.7490196228027344,0.7882353067398071,0.7921568751335144,0.7333333492279053,0.5921568870544434,0.42352941632270813,0.3607843220233917,0.4117647111415863,0.6431372761726379,0.6666666865348816,0.41960784792900085,0.37254902720451355,0.3843137323856354,0.35686275362968445,0.4313725531101227,0.3019607961177826,0.3019607961177826,0.27843138575553894,0.24313725531101227,0.22745098173618317,0.18431372940540314,0.1411764770746231,0.13725490868091583,0.25882354378700256,0.2980392277240753,0.250980406999588,0.34117648005485535,0.3333333432674408,0.2666666805744171,0.3921568691730499,0.6313725709915161,0.7254902124404907,0.7372549176216125,0.7372549176216125,0.6745098233222961,0.5921568870544434,0.5254902243614197,0.4745098054409027,0.4627451002597809,0.5254902243614197,0.45490196347236633,0.32156863808631897,0.30588236451148987,0.35686275362968445,0.3294117748737335,0.40784314274787903,0.32549020648002625,0.29019609093666077,0.250980406999588,0.24313725531101227,0.23137255012989044,0.20000000298023224,0.12156862765550613,0.125490203499794,0.3019607961177826,0.3176470696926117,0.23529411852359772,0.33725491166114807,0.3450980484485626,0.27450981736183167,0.34117648005485535,0.5137255191802979,0.6117647290229797,0.6235294342041016,0.6313725709915161,0.5843137502670288,0.5529412031173706,0.5490196347236633,0.47058823704719543,0.3764705955982208,0.3294117748737335,0.29019609093666077,0.2862745225429535,0.250980406999588,0.30980393290519714,0.3529411852359772,0.43529412150382996,0.4156862795352936,0.2862745225429535,0.21568627655506134,0.21176470816135406,0.1882352977991104,0.16470588743686676,0.11372549086809158,0.14901961386203766,0.3294117748737335,0.33725491166114807,0.27450981736183167,0.3176470696926117,0.3333333432674408,0.3333333432674408,0.43529412150382996,0.5137255191802979,0.5568627715110779,0.5960784554481506,0.6117647290229797,0.572549045085907,0.5176470875740051,0.5176470875740051,0.47058823704719543,0.3450980484485626,0.29019609093666077,0.2823529541492462,0.3019607961177826,0.2823529541492462,0.2823529541492462,0.3490196168422699,0.4431372582912445,0.4941176474094391,0.3490196168422699,0.2705882489681244,0.239215686917305,0.16862745583057404,0.1411764770746231,0.12156862765550613,0.18431372940540314,0.3019607961177826,0.32156863808631897,0.30588236451148987,0.2862745225429535,0.3176470696926117,0.40392157435417175,0.5568627715110779,0.6196078658103943,0.6392157077789307,0.6431372761726379,0.658823549747467,0.6549019813537598,0.5803921818733215,0.5568627715110779,0.5333333611488342,0.42352941632270813,0.32156863808631897,0.2823529541492462,0.2862745225429535,0.3019607961177826,0.29019609093666077,0.34117648005485535,0.48235294222831726,0.5058823823928833,0.4117647111415863,0.3490196168422699,0.3176470696926117,0.23529411852359772,0.2078431397676468,0.19607843458652496,0.20392157137393951,0.2549019753932953,0.29019609093666077,0.2823529541492462,0.2666666805744171,0.3333333432674408,0.4431372582912445,0.5843137502670288,0.6470588445663452,0.6509804129600525,0.6509804129600525,0.6745098233222961,0.6823529601097107,0.6313725709915161,0.6196078658103943,0.6078431606292725,0.5058823823928833,0.3607843220233917,0.2862745225429535,0.2862745225429535,0.30588236451148987,0.29019609093666077,0.3333333432674408,0.501960813999176,0.4627451002597809,0.4117647111415863,0.3764705955982208,0.32156863808631897,0.2549019753932953,0.239215686917305,0.23137255012989044,0.21960784494876862,0.23529411852359772,0.27843138575553894,0.2980392277240753,0.3333333432674408,0.37254902720451355,0.45098039507865906,0.5803921818733215,0.6392157077789307,0.6392157077789307,0.6549019813537598,0.6823529601097107,0.6823529601097107,0.658823549747467,0.6627451181411743,0.6705882549285889,0.6235294342041016,0.48627451062202454,0.35686275362968445,0.3137255012989044,0.32156863808631897,0.32549020648002625,0.3294117748737335,0.46666666865348816,0.4274509847164154,0.3960784375667572,0.3686274588108063,0.27843138575553894,0.21960784494876862,0.2549019753932953,0.2666666805744171,0.23137255012989044,0.24705882370471954,0.3333333432674408,0.3686274588108063,0.3450980484485626,0.33725491166114807,0.40392157435417175,0.5254902243614197,0.6039215922355652,0.6392157077789307,0.6627451181411743,0.6705882549285889,0.6784313917160034,0.686274528503418,0.686274528503418,0.6901960968971252,0.6980392336845398,0.6274510025978088,0.47843137383461,0.4117647111415863,0.40392157435417175,0.4156862795352936,0.3843137323856354,0.42352941632270813,0.41960784792900085,0.4313725531101227,0.3450980484485626,0.2666666805744171,0.23137255012989044,0.27450981736183167,0.2666666805744171,0.22745098173618317,0.25882354378700256,0.3607843220233917,0.3764705955982208,0.3294117748737335,0.30980393290519714,0.3490196168422699,0.47058823704719543,0.6000000238418579,0.6470588445663452,0.658823549747467,0.6745098233222961,0.686274528503418,0.6901960968971252,0.7058823704719543,0.7137255072593689,0.7215686440467834,0.7137255072593689,0.6549019813537598,0.5411764979362488,0.4313725531101227,0.4274509847164154,0.4117647111415863,0.4117647111415863,0.4627451002597809,0.4431372582912445,0.32549020648002625,0.30588236451148987,0.30588236451148987,0.34117648005485535,0.3294117748737335,0.2862745225429535,0.29019609093666077,0.37254902720451355,0.3803921639919281,0.37254902720451355,0.41960784792900085,0.45098039507865906,0.47843137383461,0.6000000238418579,0.6823529601097107,0.6901960968971252,0.6980392336845398,0.6980392336845398,0.7019608020782471,0.7176470756530762,0.7333333492279053,0.7450980544090271,0.7490196228027344,0.7490196228027344,0.5921568870544434,0.3764705955982208,0.3529411852359772,0.3529411852359772,0.48235294222831726,0.48235294222831726,0.37254902720451355,0.33725491166114807,0.3921568691730499,0.4431372582912445,0.5058823823928833,0.5215686559677124,0.4588235318660736,0.40392157435417175,0.4000000059604645,0.40392157435417175,0.41960784792900085,0.5176470875740051,0.5921568870544434,0.5647059082984924,0.6039215922355652,0.686274528503418,0.7058823704719543,0.7019608020782471,0.7058823704719543,0.7176470756530762,0.7333333492279053,0.7372549176216125,0.7450980544090271,0.7529411911964417,0.7686274647712708,0.5568627715110779,0.3333333432674408,0.3176470696926117,0.32156863808631897,0.4901960790157318,0.3843137323856354,0.3450980484485626,0.3843137323856354,0.46666666865348816,0.5647059082984924,0.6196078658103943,0.615686297416687,0.6000000238418579,0.529411792755127,0.4588235318660736,0.45490196347236633,0.48235294222831726,0.5843137502670288,0.6745098233222961,0.658823549747467,0.6509804129600525,0.6823529601097107,0.6980392336845398,0.6980392336845398,0.7098039388656616,0.7254902124404907,0.7333333492279053,0.7372549176216125,0.7450980544090271,0.7568627595901489,0.7176470756530762,0.501960813999176,0.3137255012989044,0.3176470696926117,0.33725491166114807,0.3686274588108063,0.2666666805744171,0.3686274588108063,0.3960784375667572,0.47843137383461,0.6117647290229797,0.658823549747467,0.6627451181411743,0.6549019813537598,0.6196078658103943,0.5647059082984924,0.5529412031173706,0.6078431606292725,0.6784313917160034,0.7137255072593689,0.7176470756530762,0.7137255072593689,0.7098039388656616,0.7137255072593689,0.7254902124404907,0.729411780834198,0.7254902124404907,0.7254902124404907,0.7333333492279053,0.7568627595901489,0.772549033164978,0.6196078658103943,0.4431372582912445,0.3764705955982208,0.34117648005485535,0.32156863808631897,0.364705890417099,0.33725491166114807,0.3764705955982208,0.47843137383461,0.6274510025978088,0.686274528503418,0.686274528503418,0.686274528503418,0.6745098233222961,0.6745098233222961,0.6627451181411743,0.6509804129600525,0.686274528503418,0.7254902124404907,0.7254902124404907,0.7411764860153198,0.7607843279838562,0.7568627595901489,0.7450980544090271,0.7490196228027344,0.7490196228027344,0.7372549176216125,0.729411780834198,0.7450980544090271,0.729411780834198,0.7019608020782471,0.5529412031173706,0.4156862795352936,0.40392157435417175,0.40784314274787903,0.3529411852359772,0.6000000238418579,0.5254902243614197,0.545098066329956,0.6705882549285889,0.7568627595901489,0.7450980544090271,0.7176470756530762,0.7019608020782471,0.7019608020782471,0.6980392336845398,0.686274528503418,0.658823549747467,0.6705882549285889,0.7098039388656616,0.7215686440467834,0.7411764860153198,0.7764706015586853,0.772549033164978,0.7607843279838562,0.7450980544090271,0.7450980544090271,0.7450980544090271,0.7215686440467834,0.729411780834198,0.6901960968971252,0.5882353186607361,0.4274509847164154,0.3294117748737335,0.25882354378700256,0.20392157137393951,0.21960784494876862,0.7137255072593689,0.6901960968971252,0.7254902124404907,0.7411764860153198,0.7450980544090271,0.7490196228027344,0.729411780834198,0.7058823704719543,0.7215686440467834,0.729411780834198,0.6941176652908325,0.6627451181411743,0.658823549747467,0.686274528503418,0.7176470756530762,0.7529411911964417,0.7764706015586853,0.7686274647712708,0.7568627595901489,0.7529411911964417,0.7529411911964417,0.7490196228027344,0.7137255072593689,0.6941176652908325,0.6549019813537598,0.4941176474094391,0.3764705955982208,0.3333333432674408,0.3176470696926117,0.30588236451148987,0.27843138575553894,0.7490196228027344,0.7529411911964417,0.772549033164978,0.772549033164978,0.7764706015586853,0.7764706015586853,0.7686274647712708,0.7019608020782471,0.6705882549285889,0.7137255072593689,0.6941176652908325,0.6705882549285889,0.6705882549285889,0.6784313917160034,0.7137255072593689,0.7490196228027344,0.7607843279838562,0.7647058963775635,0.7607843279838562,0.7450980544090271,0.7372549176216125,0.729411780834198,0.6941176652908325,0.6313725709915161,0.5803921818733215,0.48235294222831726,0.4588235318660736,0.5176470875740051,0.6039215922355652,0.6078431606292725,0.5607843399047852 };
    float* conv_1_output = (float*)calloc(CONV_1_OUT_CHANNELS * (int)(IMAGE_H / 2.0 - 1 / 2.0) * (int)(IMAGE_W / 2.0 - 1 / 2.0), sizeof(float));
    float* conv_2_output = (float*)calloc(CONV_2_OUT_CHANNELS * (int)(IMAGE_H / 4.0 - 3 / 4.0) * (int)(IMAGE_W / 4.0 - 3 / 4.0), sizeof(float));
    float* conv_3_output = (float*)calloc(CONV_3_OUT_CHANNELS * (int)(IMAGE_H / 8.0 - 7 / 8.0) * (int)(IMAGE_W / 8.0 - 7 / 8.0), sizeof(float));
    float* conv_4_output = (float*)calloc(CONV_4_OUT_CHANNELS * (int)(IMAGE_H / 16.0 - 15 / 16.0) * (int)(IMAGE_W / 16.0 - 15 / 16.0), sizeof(float));

    conv2d_3x3_p1_s2(image, &conv_1_weight[0][0][0][0], conv_1_bias, conv_1_output, 1,
        IMAGE_H, IMAGE_W,
        CONV_1_OUT_CHANNELS, CONV_1_IN_CHANNELS,
        KERNEL_H, KERNEL_W
    );
    conv2d_3x3_p1_s2(conv_1_output, &conv_2_weight[0][0][0][0], conv_2_bias, conv_2_output, 1,
        (IMAGE_H / 2), (IMAGE_W / 2),
        CONV_2_OUT_CHANNELS, CONV_2_IN_CHANNELS,
        KERNEL_H, KERNEL_W
    );
    conv2d_3x3_p1_s2(conv_2_output, &conv_3_weight[0][0][0][0], conv_3_bias, conv_3_output, 1,
        (IMAGE_H / 4), (IMAGE_W / 4),
        CONV_3_OUT_CHANNELS, CONV_3_IN_CHANNELS,
        KERNEL_H, KERNEL_W
    );
    conv2d_3x3_p1_s2(conv_3_output, &conv_4_weight[0][0][0][0], conv_4_bias, conv_4_output, 0,
        (IMAGE_H / 8), (IMAGE_W / 8),
        CONV_4_OUT_CHANNELS, CONV_4_IN_CHANNELS,
        KERNEL_H, KERNEL_W
    );

    printf("Output:\n"); // 分类，最后一层输出多个浮点数，第几个大就是第几类
    for (int i = 0; i < CONV_4_OUT_CHANNELS; i++) {
        printf("%3d: %.6f\n", i, conv_4_output[i]);
	}

    free(conv_1_output);
    free(conv_2_output);
    free(conv_3_output);
    free(conv_4_output);

    return 0;
}
